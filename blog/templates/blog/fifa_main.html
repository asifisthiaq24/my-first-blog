{% extends 'blog/base.html' %}
{% block content %}
<div class="row" ng-controller="fifaController" style="margin:10px;margin-top:0px;">
    <div class="container">
        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="#map_tab">Map</a></li>
            <li><a data-toggle="tab" href="#ds_tab">Disease Situation</a></li>
        </ul>
        <div class="tab-content">
            <div id="map_tab" class="tab-pane fade in active">
                <center>
                    <div id="map" style="width: 600px; height: 600px;margin-top:2%;"></div>
                </center>
            </div>
            <div id="ds_tab" class="tab-pane fade">
                <center>
                    <div id=testDiv style="margin-top:2%">
                    </div>
                    <hr>
                    <hr>
                    <table id="dt_test" class="table table-bordered table-hover nowrap">

                        <thead class="flip-content check">
                            <tr>
                                <th> Name</th>
                                <th> Email</th>
                                <th> Phone</th>
                                <th> Region</th>
                            </tr>
                        </thead>
                        <tbody>


                        </tbody>
                    </table>
                </center>
            </div>
        </div>
    </div>
    <!-- <center>
        <div id="map" style="width: 600px; height: 600px;"></div>
    </center> -->
    <!-- <center>
        <div id=testDiv style="margin-top:20%">

        </div>
        <hr>
        <hr>
        <table id="dt_test" class="table table-bordered table-hover nowrap">

            <thead class="flip-content check">
                <tr>
                    <th> Name</th>
                    <th> Email</th>
                    <th> Phone</th>
                    <th> Region</th>
                </tr>
            </thead>
            <tbody>


            </tbody>
        </table>
    </center> -->
</div>
<style>
        .itag {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
    
        /* #map {
            width: 780px;
            height: 650px;
            margin-left: -20px;
        } */
    
        .info {
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            background: white;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
    
        /* .info h4 {
            margin: 0 0 5px;
            color: #777;
        } */
    
        .legend {
            text-align: left;
            line-height: 18px;
            color: #555;
        }
    
        /* .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 1;
        } */
    </style>
    <!--MY Code S-->
    <script src="/static/BGD_adm3.js"> </script>
    <script>
    
        var map = L.map('map').setView([23.946096, 90.128173], 7);
    
        L.tileLayer('http://{s}.tile.cloudmade.com/{key}/{styleId}/256/{z}/{x}/{y}.png', {
            attribution: 'Map data &copy; 2011 OpenStreetMap contributors, Imagery &copy; 2011 CloudMade',
            key: 'BC9A493B41014CAABB98F0471D759707',
            styleId: 22677
        }).addTo(map);
    
        // control that shows state info on hover
        var info = L.control();
    
        info.onAdd = function (map) {
            this._div = L.DomUtil.create('div', 'info');
            this.update();
            return this._div;
        };
    
        info.update = function (props) {
            this._div.innerHTML = '<h3>Sample Distribution</h3>' + (props ?
                '<br /><b>' + 'Division -> ' + props.NAME_1 + ' </b> ' +
                '<br /><b>' + 'District -> ' + props.NAME_2 + ' </b> ' +
                '<br /><b>' + 'Upazila -> ' + props.NAME_3 + ' </b> '
                : 'Hover over a Upazila');
        };
    
        info.addTo(map);
    
        function style(feature) {
            return {
                weight: 1,
                opacity: 1,
                color: 'white',
                dashArray: '3',
                fillOpacity: 0.7,
                fillColor: getColor(feature.properties.ID_3)
                //fillColor: getColor(feature.properties.NAME_3)
            };
        }
        // function gc(perc) {
        //     var r, g, b = 0;
        //     if (perc < 50) {
        //         r = 255;
        //         g = Math.round(5.1 * perc);
        //     }
        //     else {
        //         g = 255;
        //         r = Math.round(510 - 5.10 * perc);
        //     }
        //     var h = r * 0x10000 + g * 0x100 + b * 0x1;
        //     return '#' + ('000000' + h.toString(16)).slice(-6);
        // }
        // var green_to_red = [
        // {key : 0,background: '#0dff00'},
        // {key :  5,background: '#63b682'},
        // {key :  10,background: '#73b87e'},
        // {key :  15,background: '#84bb7b'},
        // {key :  20,background: '#94bd77'},
        // {key :  25,background: '#a4c073'},
        // {key :  30,background: '#b0be6e'},
        // {key :  35,background: '#c4c56d'},
        // {key :  40,background: '#d4c86a'},
        // {key :  45,background: '#e2c965'},
        // {key :  50,background: '#f5ce62'},
        // {key :  55,background: '#f3c563'},
        // {key :  60,background: '#e9b861'},
        // {key :  65,background: '#e6ad61'},
        // {key :  70,background: '#ecac67'},
        // {key :  75,background: '#e9a268'},
        // {key :  80,background: '#e79a69'},
        // {key :  85,background: '#e5926b'},
        // {key :  90,background: '#e2886c'},
        // {key :  95,background: '#e0816d'},
        // {key : 100,background: '#ff1100'}
        // ]
        var green_to_red = [
    
            //{ key: 0, background: '#2d6063' },
            { key: 10, background: 'green' },
            { key: 20, background: '#91ff00' },
            { key: 30, background: '#aaff00' },
            { key: 40, background: '#d4ff00' },
            { key: 50, background: '#ffc400' },
            { key: 60, background: '#ffa200' },
            { key: 70, background: '#ff8400' },
            { key: 80, background: '#ff5e00' },
            { key: 90, background: 'red' },
            { key: 100, background: '#c91b00' }
        ]
    
        const gc = (pt) => {
            for (i = 0; i < green_to_red.length; i++) {
                if (green_to_red[i].key == pt) {
                    return green_to_red[i].background
                }
            }
        }
        function getColor(s) {
            if (s == 286) return gc(70)
            else if (s == 282) return gc(90)
            else if (s == 283) return gc(100)
            else if (s == 284) return gc(50)
            else if (s == 285) return gc(60)
            else if (s == 286) return gc(90)
            else if (s == 287) return gc(80)
            else if (s == 223) return gc(40)
            else if (s == 221) return gc(30)
            else if (s == 138) return gc(20)
            else if (s == 135) return gc(10)
            // else if (s == 133) return gc(10)
            else return '#275c29'
            // if (s == 286) return 'black'
            // else if (s == 282) return '#bf3f54'
            // else if (s == 283) return '#b34fdf'
            // else if (s == 284) return '#cf3f5e'
            // else if (s == 285) return '#ef3a54'
            // else if (s == 286) return '#ff3f54'
            // else if (s == 287) return '#fa3faa'
            // else return '#167008'
            // if(s=='Kushtia S.') return 'black'
            // else if(s=='Mirpur') return '#bf3f54'
            // else if(s=='Bheramara') return '#bfffdf'
            // else if(s=='Khoksa') return '#cf3f5e'
            // else if(s=='Kumarkhali') return '#ef3a54'
            // else return '#167008'
        }
    
        function onEachFeature(feature, layer) {
            layer.on({
                mouseover: highlightFeature,
                mouseout: resetHighlight,
                click: zoomToFeature
            });
        }
        function highlightFeature(e) {
            var layer = e.target;
            layer.setStyle({
                weight: 1,
                color: '#000000',
                dashArray: '',
                fillOpacity: 0.7,
            });
            if (!L.Browser.ie && !L.Browser.opera) {
                layer.bringToFront();
            }
            info.update(layer.feature.properties);
        }
        var geojson;
        function resetHighlight(e) {
            geojson.resetStyle(e.target);
            info.update();
        }
        function zoomToFeature(e) {
            map.fitBounds(e.target.getBounds());
        }
        geojson = L.geoJSON(json_upazilla, {
            style: style,
            onEachFeature: onEachFeature
        }).addTo(map);
    
        var countList = [22, 123, 234, 12,0,456, 555, 22,1223, 124, 456, 223, 347, 324, 345, 63, 21, 12, 66, 99, 199, 89, 189]
        var min = Math.min.apply(null, countList)
        var max = Math.max.apply(null, countList)
    
        var diff = max - min;
        var rem = Math.ceil(diff / 10);
        let new_min = min
        let range = [];
        for (let i = 0; i < 10; i++) {
            if (new_min + rem > max) range.push((new_min+1) + '-' + max)
            else range.push((new_min+1) + '-' + (new_min + rem))
            new_min = new_min + rem
        }
        console.log(range)
        console.log(min)
        console.log(max)
        console.log(rem)
        var legend = L.control({ position: 'bottomleft' });
    
        legend.onAdd = function (map) {
    
            var div = L.DomUtil.create('div', 'info legend')
            var labels = [];
            labels.push(
                    '<i class="itag" style="background:#275c29"></i> ' +
                    0+'</br>');
            for (var i = 0; i < range.length; i++) {
                labels.push(
                    '<i class="itag" style="background:' + green_to_red[i].background + '"></i> ' +
                    range[i]+'</br>');
            }
    
            div.innerHTML = labels.join('<br>');
            return div;
        };
        legend.addTo(map);
        // var ll = 23.83644294738781
        // var lg = 88.86476898193371
        var ll = 23.8907
        var lg = 89.1099
        // setInterval(function () {
        //     map.setZoom(7);
        //     setTimeout(function () {
        //         //var marker = L.marker([23.8907, 89.1099], {}).addTo(map);
        //         //map.flyTo([23.8907, 89.1099], 11);
        //         var marker = L.marker([ll, lg], {}).addTo(map);
        //         map.flyTo([ll,lg], 10);
    
        //     }, 1000);
        // }, 5000)
        setTimeout(function () {
            var marker = L.marker([ll, lg], {}).addTo(map);
            map.flyTo([ll, lg], 10.5);
        }, 1000);
    
    </script>
<!-- <script>

    var map = L.map('map').setView([23.946096, 90.128173], 7);

    L.tileLayer('http://{s}.tile.cloudmade.com/{key}/{styleId}/256/{z}/{x}/{y}.png', {
        attribution: 'Map data &copy; 2011 OpenStreetMap contributors, Imagery &copy; 2011 CloudMade',
        key: 'BC9A493B41014CAABB98F0471D759707',
        styleId: 22677
    }).addTo(map);

    // control that shows state info on hover
    var info = L.control();

    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
    };

    info.update = function (props) {
        this._div.innerHTML = '<h3>Sample Distribution</h3>' + (props ?
            '<br /><b>' + 'Division -> ' + props.NAME_1 + ' </b> ' +
            '<br /><b>' + 'District -> ' + props.NAME_2 + ' </b> ' +
            '<br /><b>' + 'Upazila -> ' + props.NAME_3 + ' </b> '
            : 'Hover over a Upazila');
    };

    info.addTo(map);

    function style(feature) {
        return {
            weight: 1,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.7,
            fillColor: getColor(feature.properties.ID_3)
            //fillColor: getColor(feature.properties.NAME_3)
        };
    }
    function getColor(s) {
        if (s == 286) return 'black'
        else if (s == 282) return '#bf3f54'
        else if (s == 283) return '#b34fdf'
        else if (s == 284) return '#cf3f5e'
        else if (s == 285) return '#ef3a54'
        else if (s == 286) return '#ff3f54'
        else if (s == 287) return '#fa3faa'
        else return '#167008'
        // if(s=='Kushtia S.') return 'black'
        // else if(s=='Mirpur') return '#bf3f54'
        // else if(s=='Bheramara') return '#bfffdf'
        // else if(s=='Khoksa') return '#cf3f5e'
        // else if(s=='Kumarkhali') return '#ef3a54'
        // else return '#167008'
    }

    function onEachFeature(feature, layer) {
        layer.on({
            mouseover: highlightFeature,
            mouseout: resetHighlight,
            click: zoomToFeature
        });
    }
    function highlightFeature(e) {
        var layer = e.target;
        layer.setStyle({
            weight: 1,
            color: '#000000',
            dashArray: '',
            fillOpacity: 0.7,
        });
        if (!L.Browser.ie && !L.Browser.opera) {
            layer.bringToFront();
        }
        info.update(layer.feature.properties);
    }
    var geojson;
    function resetHighlight(e) {
        geojson.resetStyle(e.target);
        info.update();
    }
    function zoomToFeature(e) {
        map.fitBounds(e.target.getBounds());
    }
    geojson = L.geoJSON(json_upazilla, {
        style: style,
        onEachFeature: onEachFeature
    }).addTo(map);
    // var ll = 23.83644294738781
    // var lg = 88.86476898193371
    var ll = 23.8907
    var lg = 89.1099
    // setInterval(function () {
    //     map.setZoom(7);
    //     setTimeout(function () {
    //         //var marker = L.marker([23.8907, 89.1099], {}).addTo(map);
    //         //map.flyTo([23.8907, 89.1099], 11);
    //         var marker = L.marker([ll, lg], {}).addTo(map);
    //         map.flyTo([ll,lg], 10);

    //     }, 1000);
    // }, 5000)
    setTimeout(function () {
        var marker = L.marker([ll, lg], {}).addTo(map);
        map.flyTo([ll, lg], 10.5);
    }, 500);

</script> -->
<script>
    function Person(name, age, position) {
        this._name = name;
        this._age = age;
        this._position = position;

        this.name = function () {
            return this._name;
        };

        this.age = function () {
            return this._age;
        };

        this.position = function () {
            return this._position;
        };
    }
    $(document).ready(function () {
        //
        $.ajax({
            url: '/test/',
            dataType: 'html',
            success: function (response) {
                $('#testDiv').html(response);
                $('#T_my_id').DataTable();
            }
        });
        $('#dt_test').DataTable(
            {
                "retrieve": true,
                "processing": true,
                "serverSide": true,
                "bFilter": false,
                "ajax": {
                    "url": "/pagination/",
                    "type": "POST",
                    "data": function (d) { }

                }
            }
        )

        //
        var table = $('#example').DataTable({
            "paging": true, //add pagination
            //"ordering": true,// orders data
            "order": [[3, 'asc'], [5, 'desc']], // sort on specif column / columns
            //here data is sorted based on column  in desc/asc order index start from 0 
            "info": true,//shows -- Showing 1 to 10 of N entries--
            // columns: [
            //     { data: null, render: 'name' },
            //     { data: null, render: 'age' },
            //     { data: null, render: 'position' }
            // ]
            data: dataSet, //loading using js
            columns: [
                { title: "Name" },
                { title: "Position" },
                { title: "Office" },
                { title: "Extn." },
                { title: "Start date" },
                { title: "Salary" }
            ],
            //for serverside processing
            //"processing": true,
            //"serverSide": true,
            //"ajax": "../server_side/scripts/server_processing.php"

            //
        });

        //for ajax json---- df.tojson kore pathai dibo
        /*$('#example').dataTable({
            "ajax": {
                "url": "data.json",
                "dataSrc": function (json) {
                    for (var i = 0, ien = json.data.length; i < ien; i++) {
                        json.data[i][0] = '<a href="/message/' + json.data[i][0] + '>View message</a>';
                    }
                    return json.data;
                }
            }
        });
        // //--

        ajax: {
            url: "/api_endpoint/",
                dataSrc: "data"
        }, */

        //

        // table.row.add(new Person('adssaAiri Satou', 33, 'xAccountant'));
        // table.row.add(new Person('Angelica Ramos', 47, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Addsshton Cox', 66, 'Junior Technical Author'));
        // table.row.add(new Person('vAisri Satou', 33, 'aAaaacaacountant'));
        // table.row.add(new Person('Angvelica Ramos', 47, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Avshton Cox', 66, 'Junior Technical Author'));
        // table.row.add(new Person('cAiri Satou', 33, 'Accountant'));
        // table.row.add(new Person('Angelica Ramos', 47, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Acshton Cox', 646, 'Junior Technical Author'));
        // table.row.add(new Person('Airi Satou', 33, 'Accountant'));
        // table.row.add(new Person('Angelica Ramos', 447, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Ashton Cox', 66, 'Junior Technical Author'));
        // table.row.add(new Person('Airi Satou', 33, 'Accountant'));
        // table.row.add(new Person('Angelica Ramos', 47, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Ashton Cox', 66, 'Junior Technical Author'));
        // table.row.add(new Person('Airi Satou', 33, 'Accountant'));
        // table.row.add(new Person('Angelica Ramos', 47, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Ashton Cox', 66, 'Junior Technical Author'));
        // table.row.add(new Person('Airi Satou', 33, 'Accountant'));
        // table.row.add(new Person('Angelica Ramos', 47, 'Chief Executive Officer (CEO)'));
        // table.row.add(new Person('Ashton Cox', 66, 'Junior Technical Author'));
        // table.draw();
    });
    app.controller("fifaController", function ($scope, NgTableParams) {
        $scope.vms = this;
        var vms = this;
        vms.model = {};
        $scope.test = "Asif Isthiaq AJS"
        vms.model.msg = 'FIFA'
    });

    var dataSet = [
        ["Tiger Nixon", "System Architect", "Edinburgh", "5421", "2011/04/25", "$320,800"],
        ["Garrett Winters", "Accountant", "Tokyo", "8422", "2011/07/25", "$170,750"],
        ["Ashton Cox", "Junior Technical Author", "San Francisco", "1562", "2009/01/12", "$86,000"],
        ["Cedric Kelly", "Senior Javascript Developer", "Edinburgh", "6224", "2012/03/29", "$433,060"],
        ["Airi Satou", "Accountant", "Tokyo", "5407", "2008/11/28", "$162,700"],
        ["Brielle Williamson", "Integration Specialist", "New York", "4804", "2012/12/02", "$372,000"],
        ["Herrod Chandler", "Sales Assistant", "San Francisco", "9608", "2012/08/06", "$137,500"],
        ["Rhona Davidson", "Integration Specialist", "Tokyo", "6200", "2010/10/14", "$327,900"],
        ["Colleen Hurst", "Javascript Developer", "San Francisco", "2360", "2009/09/15", "$205,500"],
        ["Sonya Frost", "Software Engineer", "Edinburgh", "1667", "2008/12/13", "$103,600"],
        ["Jena Gaines", "Office Manager", "London", "3814", "2008/12/19", "$90,560"],
        ["Quinn Flynn", "Support Lead", "Edinburgh", "9497", "2013/03/03", "$342,000"],
        ["Charde Marshall", "Regional Director", "San Francisco", "6741", "2008/10/16", "$470,600"],
        ["Haley Kennedy", "Senior Marketing Designer", "London", "3597", "2012/12/18", "$313,500"],
        ["Tatyana Fitzpatrick", "Regional Director", "London", "1965", "2010/03/17", "$385,750"],
        ["Michael Silva", "Marketing Designer", "London", "1581", "2012/11/27", "$198,500"],
        ["Paul Byrd", "Chief Financial Officer (CFO)", "New York", "3059", "2010/06/09", "$725,000"],
        ["Gloria Little", "Systems Administrator", "New York", "1721", "2009/04/10", "$237,500"],
        ["Bradley Greer", "Software Engineer", "London", "2558", "2012/10/13", "$132,000"],
        ["Dai Rios", "Personnel Lead", "Edinburgh", "2290", "2012/09/26", "$217,500"],
        ["Jenette Caldwell", "Development Lead", "New York", "1937", "2011/09/03", "$345,000"],
        ["Yuri Berry", "Chief Marketing Officer (CMO)", "New York", "6154", "2009/06/25", "$675,000"],
        ["Caesar Vance", "Pre-Sales Support", "New York", "8330", "2011/12/12", "$106,450"],
        ["Doris Wilder", "Sales Assistant", "Sydney", "3023", "2010/09/20", "$85,600"],
        ["Angelica Ramos", "Chief Executive Officer (CEO)", "London", "5797", "2009/10/09", "$1,200,000"],
        ["Gavin Joyce", "Developer", "Edinburgh", "8822", "2010/12/22", "$92,575"],
        ["Jennifer Chang", "Regional Director", "Singapore", "9239", "2010/11/14", "$357,650"],
        ["Brenden Wagner", "Software Engineer", "San Francisco", "1314", "2011/06/07", "$206,850"],
        ["Fiona Green", "Chief Operating Officer (COO)", "San Francisco", "2947", "2010/03/11", "$850,000"],
        ["Shou Itou", "Regional Marketing", "Tokyo", "8899", "2011/08/14", "$163,000"],
        ["Michelle House", "Integration Specialist", "Sydney", "2769", "2011/06/02", "$95,400"],
        ["Suki Burks", "Developer", "London", "6832", "2009/10/22", "$114,500"],
        ["Prescott Bartlett", "Technical Author", "London", "3606", "2011/05/07", "$145,000"],
        ["Gavin Cortez", "Team Leader", "San Francisco", "2860", "2008/10/26", "$235,500"],
        ["Martena Mccray", "Post-Sales support", "Edinburgh", "8240", "2011/03/09", "$324,050"],
        ["Unity Butler", "Marketing Designer", "San Francisco", "5384", "2009/12/09", "$85,675"]
    ];
</script>

{% endblock content %}